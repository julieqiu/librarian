# Release Ownership and Control

## The Problem: Centralized Release Control vs. Distributed Release Needs

This issue highlights a fundamental tension in automated release workflows: when a central automation system (like `librarianops`) takes over the release process for a repository, the repository's maintainers (the language teams) can lose control over the precise timing and conditions of releases for specific features or libraries within their own repository.

*   **Loss of Flexibility:** Once a repository is onboarded to `librarian` for release automation, PRs generated by `librarianops` are merged without intervention from the language team. This means the language team loses the ability to strategically hold off a release for various reasons (e.g., waiting for a dependent feature, unblocking other work, or aligning with marketing efforts).
*   **Example:** The Python team might need to delay the release of `gapic-generator-python` because it's a dependency for another critical feature they're developing. An automated release would disrupt their internal plans.
*   **Communication Overhead:** Without a direct control mechanism, language teams would have to engage in manual, toilsome communication with the Librarian team to request release blocks, creating friction and delays.
*   **Onboarding Blocker:** This lack of control is a blocker for onboarding new repositories, as language teams are hesitant to surrender release autonomy.

### The Core Gap in Roles:

*   **Release Need Origin:** The strategic need for a release (or to hold one) originates from within the repository maintainer team (e.g., the Python language team).
*   **Release Control:** The Librarian team (via `librarianops`) controls the execution of releases.
*   **Knowledge Disconnect:** The Librarian team, operating at a platform level, does not inherently possess the granular knowledge of release readiness and internal dependencies within each language repository. (This contrasts with models like Release Please, where repository maintainers themselves directly trigger and manage their releases within their own repository context).

## Solution Strategy: Empowering Language Teams with `release: false`

The `librarian` design addresses this by providing language teams with a direct, declarative mechanism to control release eligibility for individual libraries within their `librarian.yaml` configuration.

### Mechanism: `release: false` Flag

By setting `release: false` for a specific library in `librarian.yaml`, the language team explicitly signals to `librarianops` that this library should be excluded from automated release preparation and publishing.

```yaml
libraries:
  - name: gapic-generator-python
    version: 1.2.3
    release: false # LibrarianOps will skip releasing this library
```

### Workflow

1.  **Language Team Decision:** The language team determines that a specific library needs its release held.
2.  **Configuration Update:** The language team creates a PR in their repository to set `release: false` for that library in `librarian.yaml`.
3.  **Automation Respects Policy:** When `librarianops release` runs, it reads the updated `librarian.yaml`. Upon encountering `release: false` for `gapic-generator-python`, it will gracefully skip preparing a release for that library, while continuing to process other eligible libraries.
4.  **Re-enabling Release:** When the language team is ready to release the library, they create another PR to remove or change `release: false` to `true` (or remove the flag, implying `true`), allowing `librarianops` to resume normal release automation for that library.

### Benefits

*   **Decentralized Control:** Language teams regain direct control over the release timing of their libraries.
*   **Reduced Toil:** Eliminates the need for manual communication channels with the Librarian team to block or unblock releases.
*   **Unblocked Onboarding:** Removes a significant blocker for onboarding new repositories to `librarian` automation.
*   **Clear Audit Trail:** Release blocks are explicitly recorded in `librarian.yaml` and visible in Git history.

## Related Issues

*   [GitHub Issue #2951: Flag to hold off releasing a feature in a particular repo](https://github.com/googleapis/librarian/issues/2951)
