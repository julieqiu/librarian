# Reference librarian.yaml Configuration
# This file serves as the specification and example for the librarian.yaml schema.
#
# Unified Config Initiative:
# - Authoritative source for language-specific configuration.
# - Replaces legacy settings in BUILD.bazel and GAPIC YAML.
# - Implements safe file management via explicit deletion patterns.

# --- Global Repository Context ---
language: rust
repo: googleapis/google-cloud-rust

# --- Shared Defaults ---
default:
  output: src/generated/
  release_level: stable
  tag_format: "{name}/v{version}"
  transport: grpc+rest

  # Safe Removal Policy: Define which files to clean up before generation.
  # Prefer "remove" patterns over "preserve" patterns.
  delete_patterns:
    - "src/generated/**/*.rs"

  # Language Defaults
  rust:
    package_dependencies:
      - name: api
        package: google-cloud-api
        source: google.api
    disabled_rustdoc_warnings:
      - redundant_explicit_links
    generate_setter_samples: true

# --- Source Repositories ---
sources:
  googleapis:
    commit: 35365cb31245ac9ee3f3ed37bd052ea246ed732b
    sha256: de0831d253510c43282d607de44b60b650f00a4e3a9f388927fe3db11871f6fa
  protobuf:
    commit: b407e8416e3893036aee5af9a12bd9b6a0e2b2e6
    sha256: 55912546338433f465a552e9ef09930c63b9eb697053937416890cff83a8622d
    subpath: src

# --- Global Release Configuration ---
release:
  branch: main
  remote: upstream
  ignored_changes:
    - .repo-metadata.json
    - .sidekick.toml
  roots_pem: <path-to-roots.pem>

# --- List of Managed Libraries ---
libraries:
  - name: google-cloud-secretmanager
    version: 1.2.0

  - name: google-cloud-pubsub
    version: 0.32.0
    # Per-library file management overrides
    delete_patterns:
      - "src/pubsub/src/generated/**/*.rs"
    rust:
      modules:
        - source: google/pubsub/v1
          template: prost
          output: src/pubsub/src/generated/protos
        - source: google/pubsub/v1
          template: grpc-client
          output: src/pubsub/src/generated/gapic

  - name: google-cloud-auth
    version: 1.3.0
    generate: false

# --- Channel Configuration ---
channels:
  - path: google/cloud/secretmanager/v1

# --- Language-Specific Sections ---
rust:
  # Additional global Rust settings
  modules: []
